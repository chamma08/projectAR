<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <link rel="stylesheet" href="https://cdn.tailwindcss.com" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css"
    />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <title>AR Engine</title>
    <style>
      #ar-button {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: blue;
        color: white;
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        display: none;
        cursor: pointer;
      }
    </style>
  </head>

  <body class="bg-white text-gray-900">
    <!-- Navbar -->
    <header class="flex justify-between items-center p-4 shadow-md bg-white">
      <div class="flex items-center space-x-2">
        <h1 class="text-xl font-bold">
          ARen<span class="text-blue-600">Gine</span>
        </h1>
      </div>
    </header>

    <!-- MindAR Scene for Image Tracking -->
    <a-scene
      mindar-image="imageTargetSrc: ./targets.mind;"
      embedded
      color-space="sRGB"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
    >
      <a-camera position="0 0 0"></a-camera>
    </a-scene>

    <!-- AR Button -->
    <button
      id="ar-button"
      class="bg-blue-500 text-white py-2 w-full font-medium hover:bg-blue-600 transition"
      onclick="window.app.showChair(1);"
      style="display: none"
    >
      <i class="fas fa-camera"></i> View in AR
    </button>

    <script type="module">
      import { App } from "./app.js";

      document.addEventListener("DOMContentLoaded", function () {
        const app = new App();
        window.app = app;

        document.addEventListener("DOMContentLoaded", () => {
          const scene = document.querySelector("a-scene");
          const arButton = document.getElementById("ar-button");

          scene.addEventListener("targetFound", () => {
            console.log("Target Found!");
            arButton.style.display = "block"; // Ensure button is shown
          });

          scene.addEventListener("targetLost", () => {
            console.log("Target Lost!");
            arButton.style.display = "none"; // Ensure button hides
          });
        });
      });
    </script>
  </body>
</html>
